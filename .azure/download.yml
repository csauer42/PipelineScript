parameters:
- name: dependencies
  type: object
  default:
  - pkg: sample.bin
    version: 1.0.0
  - pkg: main.hex
    version: 0.0.6
  - pkg: avr-common
    version: 2.0.0-1-g0e5955b
- name: pkgFeed
  type: string
  default: '477fc493-2c12-4877-954a-3040372f2485/40809f3d-1cfb-45c7-b7e3-589968369bc9'

steps:
- ${{ each dep in parameters.dependencies }}:
  - task: UniversalPackages@0
    inputs:
      command: 'download'
      downloadDirectory: '$(System.DefaultWorkingDirectory)/Artifacts'
      feedsToUse: 'internal'
      vstsFeed: ${{ parameters.pkgFeed }}
      vstsFeedPackage: ${{ dep.pkg }}
      vstsPackageVersion: ${{ dep.version }}